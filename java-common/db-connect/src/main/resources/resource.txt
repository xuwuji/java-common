Mybatis 缓存

1.一级缓存
一级缓存指的是SqlSession级别，基于 PerpetualCache(mybatis自带)的 HashMap本地缓存
执行的查询会根据SQL为key被缓存,修改任何参数的值都会导致缓存失效。

简单来说就是，认为当执行一个sql，结果就是xxx

下次再执行这个sql，就直接拿出这个结果xxx

当session commit或close后，这个session内的缓存就会清空，避免脏读。


2.二级缓存
二级缓存就是global caching,它超出session范围之外,可以被所有sqlSession共享
它的实现机制和mysql的缓存一样,开启它只需要在mybatis的配置文件开启settings里的

<setting name="cacheEnabled" value="true"/>

以及在相应的Mapper文件(例如userMapper.xml)里开启

<mapper namespace="mapper.UserMapper">
   ...  select statement ...
       <!-- Cache 配置 -->
    <cache
        eviction="FIFO"
        flushInterval="60000"
        size="512"
        readOnly="true" />
</mapper>

需要注意的是global caching的作用域是针对Mapper的Namespace而言的,也就是说只在有在这个Namespace内的查询才能共享这个cache.
